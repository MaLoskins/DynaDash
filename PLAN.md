---
# **DynaDash ‚Äì Project Charter & Delivery Workflow**  
_CITS3403 / CITS5505 Group Project ‚Ä¢ Due **23:59 AWST, Friday 16 May 2025**_

---

## 1  Purpose & Scope  

DynaDash (‚ÄúDynamic Dashboard‚Äù) is a web-based data-analytics platform that lets registered users  

1. **Upload private datasets** (CSV or JSON).  
2. **Receive automated exploratory analyses & visualisations** generated by Anthropic‚Äôs Claude API.  
3. **Curate, annotate & manage those visualisations** in a personal gallery.  
4. **Selectively share chosen datasets or charts** with nominated peers on the system.

The application must expose four core views mandated by the unit specification:

| View | Mandatory Capabilities |
|------|------------------------|
| **Intro / Landing** | Brand message, feature overview, register & login forms |
| **Upload Data** | Secure file upload, preview first rows, client-side validation |
| **Visualise Data** | Render Claude-generated graphs; filter ‚ÄúMy visuals‚Äù / ‚ÄúShared with me‚Äù |
| **Share Data** | ACL interface to grant or revoke access for specific users |

---

## 2  System Architecture (descriptive)

| Layer | Components | Technologies (unit-approved) |
|-------|------------|------------------------------|
| **Frontend** | ‚Ä¢ Jinja2 HTML templates <br>‚Ä¢ Tailwind CSS layout <br>‚Ä¢ jQuery helpers <br>‚Ä¢ **AJAX** for CRUD calls <br>‚Ä¢ **WebSocket (Socket.IO)** for live progress bars | HTML / CSS / JS, Tailwind, jQuery, AJAX, Socket.IO |
| **Backend** | ‚Ä¢ Flask core app <br>‚Ä¢ Blueprints: _auth_, _data_, _visual_ <br>‚Ä¢ Service layer: DataProcessor, ClaudeClient <br>‚Ä¢ REST JSON API + Socket.IO namespace | Flask, Flask-Login, Flask-WTF, Flask-RESTful, Flask-SocketIO |
| **Database** | ‚Ä¢ **SQLite** file DB (single cross-platform file) <br>‚Ä¢ SQLAlchemy ORM models <br>‚Ä¢ Alembic migrations | **SQLite**, SQLAlchemy |
| **External Services** | ‚Ä¢ Anthropic Claude API (visual prompts) | `anthropic` Python SDK |

---

## 3  Data & Control Flow

```
User ‚Üí AJAX POST /upload ‚Üí Flask ‚Üí DataProcessor
      ‚Ü≥ save raw CSV to disk (uploads/)
      ‚Ü≥ clean & summarise with Pandas
      ‚Ü≥ emit Socket.IO ‚Äúprogress_update‚Äù (% cleaned)
      ‚Ü≥ on finish: POST metrics to Claude
Claude ‚Üí returns HTML/SVG/js snippet
Flask ‚Üí save dataset row + visual spec in SQLite
Flask ‚Üí Socket.IO ‚Äúprocessing_complete‚Äù
Browser ‚Üí refresh gallery via AJAX GET /visuals
```

* AJAX delivers the **command** (upload / share / fetch).  
* WebSocket pushes **status pings** for long-running tasks (cleaning, Claude call).  
* All persistent data (users, datasets, share ACL) live in a **single SQLite database**.

---

## 4  Component Breakdown

### 4.1  Frontend
* Tailwind palette; mobile-first.
* Widgets: _FileDropZone_, _DataPreviewModal_, _ChartCard_.
* jQuery event bus; DOMPurify before inserting Claude output.

### 4.2  Backend
* **auth** ‚Äì registration & login (Flask-Login, bcrypt).  
* **data** ‚Äì upload, dataset CRUD, share ops.  
* **visual** ‚Äì trigger analysis, retrieve charts, invalidate caches.  
* **services** ‚Äì  
  * _DataProcessor_ (null handling, outlier tag, normalise).  
  * _ClaudeClient_ (prompt template, retry, schema check).  

### 4.3  SQLite Schema v0

| table | key columns |
|-------|-------------|
| user | id, name, email (unique), pwd_hash, created_at |
| dataset | id, user_id FK, filename, n_rows, uploaded_at, is_public |
| visualisation | id, dataset_id FK, title, spec (JSON/HTML blob), created_at |
| share | id, owner_id FK, target_id FK, object_type, object_id, granted_at |

---

## 5  AJAX & WebSocket Integration Guide  

### 5.1  Why

| Feature | Use **AJAX** | Use **WebSocket** |
|---------|--------------|-------------------|
| File upload & preview | ‚úÖ | ‚ùå |
| Trigger Claude visual generation | ‚úÖ | ‚úÖ (progress pings) |
| Load ‚ÄúMy Visuals‚Äù / ‚ÄúShared With Me‚Äù | ‚úÖ | ‚ùå |
| Toggle share access | ‚úÖ | ‚ùå |
| Notify when a teammate shares a chart | ‚ùå | ‚úÖ (optional) |

### 5.2  Code Reference  

**AJAX upload (jQuery)**  

```javascript
$('#upload-form').on('submit', function (e) {
  e.preventDefault();
  const formData = new FormData(this);

  $.ajax({
    url: '/api/v1/upload',
    type: 'POST',
    data: formData,
    processData: false,
    contentType: false,
    success: () => { alert('Upload successful'); loadGallery(); },
    error: (xhr) => alert('Error: ' + xhr.responseText)
  });
});
```

**Flask endpoint**  

```python
@data_blueprint.route('/api/v1/upload', methods=['POST'])
@login_required
def upload_data():
    file = request.files.get('file')
    if not file:
        return jsonify(error='No file uploaded'), 400
    path = save_file(file)                     # util helper
    data_processor.process(path, g.user.id)    # fires async task
    return jsonify(status='queued')
```

**Live progress with Socket.IO (browser)**  

```html
<script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
<script>
  const socket = io();

  socket.emit('start_processing', { dataset_id });

  socket.on('progress_update', data => {
    $('#progress-bar').css('width', data.percent + '%');
    $('#progress-label').text(data.message);
  });

  socket.on('processing_complete', () => {
    $('#progress-label').text('Done!');
    loadGallery();
  });
</script>
```

**Flask-SocketIO server handler**

```python
from flask_socketio import SocketIO, emit
socketio = SocketIO(app, cors_allowed_origins='*')

@socketio.on('start_processing')
def process_dataset(msg):
    ds_id = msg['dataset_id']
    for step in run_pipeline(ds_id):           # generator yields progress
        emit('progress_update', step)
    emit('processing_complete')
```

*Fallback*: if WebSockets are unavailable, the UI falls back to `setInterval(fetchStatus)` polling the REST `/status/<id>` endpoint.

---

## 6  Roles & Responsibilities  

| Member | Primary Focus | Key Deliverables |
|--------|---------------|------------------|
| **Matthew Haskins** | Claude integration & chart renderer | Prompt templates, ClaudeClient, Socket.IO events |
| **Leo Chen** | DB model & REST API | SQLAlchemy models, `/api/v1/*` endpoints, validators |
| **Jonas Liu** | SQLite ops & optimisation | DB setup, Alembic migration chain, backup scripts |
| **Ziyue Xu** | Security & API gateway | JWT/session auth, rate limit, logging, DOMPurify hooks |
| **All** | Tailwind UX, testing, presentations | ‚Äî |

---

## 7  Agile Timeline (Weeks 4‚Äì10)

| Week | Milestones |
|------|------------|
| **4 (22‚Äì28 Apr)** | Decide feature set ‚Ä¢ Private GitHub repo ‚Ä¢ Low-fi HTML mock-ups |
| **5 (29 Apr‚Äì2 May)** **Deliverable 1** | GUI design pitch to facilitator |
| **6 (5‚Äì9 May)** **Deliverable 2** | Login & SQLite CRUD demo ‚Ä¢ CI (pytest, GitHub Actions) |
| **7 (10‚Äì14 May)** | Integrate Claude + AJAX + Socket.IO ‚Ä¢ Full sharing flow ‚Ä¢ Freeze features |
| **16 May** | **üì¶ Submission** ‚Äì zip & public repo due 23:59 |
| **8 (19‚Äì23 May)** | Final presentation rehearsal & delivery |

_No coding before Week 6 lecture; config files + static HTML only._

---

## 8  Version-Control & Collaboration

* `main` protected; feature branches ‚Üí PR ‚Üí review.  
* GitHub Projects board for tasks; Issues linked to commits.  
* CI: pytest + flake8 on pull request.

---

## 9  Testing & QA

* **Unit** ‚Äì utilities, auth, processors.  
* **Integration** ‚Äì upload ‚Üí Claude ‚Üí gallery.  
* **Socket tests** ‚Äì `socketio.test_client`.  
* **Accessibility** ‚Äì Lighthouse pass ‚â• 90.  
* **Coverage** ‚â• 80 %.

---

## 10  Technical Implementation Guidelines  

### 10.1  Frontend  
* Tailwind utilities, custom colours.  
* jQuery + **AJAX** for CRUD.  
* DOMPurify when injecting Claude HTML.  

### 10.2  Backend  
* Flask config per environment.  
* Flask-Login, Passlib hashing.  
* `/api/v1/` JSON REST.  
* **Flask-SocketIO** namespace `/progress`.

### 10.3  Database  
* **SQLite** for dev & prod (file path via `$DYNA_SQLITE_PATH`).  
* Alembic auto-migrations, semantic tags.

### 10.4  External Libraries  
`pandas`, `numpy`, `scipy`, `anthropic`, `python-dotenv`, `pytest`, `coverage`, `faker`.

### 10.5  Realtime Comms Recap  
* **AJAX** = mutations & reads.  
* **WebSocket** = status pings & optional share notifications.  
* Graceful fallback to REST polling.

---

## 11  Risk Register

| Risk | Impact | Mitigation |
|------|--------|------------|
| Claude rate-limit | Delayed visuals | Retry + cache ‚Ä¢ fallback Matplotlib |
| Oversized uploads | Server crash | 50 MB file limit ‚Ä¢ chunked Pandas read |
| XSS via Claude HTML | Data leak | DOMPurify clean-in, Jinja2 autoescape |
| WebSocket blocked | UX degraded | REST polling fallback |

---

## 12  Deliverables Checklist ‚úÖ

| Item | Owner | Due |
|------|-------|-----|
| HTML prototype | All | 29 Apr |
| GUI pitch (Deliverable 1) | any | Week 5 lab |
| Dynamic demo (Deliverable 2) | All | Week 6 lab |
| Tests + README | All | 14 May |
| `requirements.txt` (`pip freeze`) | Jonas | 14 May |
| Zip + public repo | Matthew | 16 May |
| Final presentation deck & live demo | All | Week 8 |

---

**DynaDash** now formally embeds the AJAX & WebSocket workflows, doubles-down on **SQLite** as the sole database, and remains 100 % compliant with the unit‚Äôs technology constraints and deliverable schedule.